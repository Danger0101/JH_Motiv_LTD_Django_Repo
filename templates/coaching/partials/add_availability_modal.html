{% comment %} This modal is loaded into #modal-container when a user clicks a calendar day. {% endcomment %}
<div
  id="availability-modal"
  class="fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center z-50"
>
  <div
    class="bg-white rounded-lg shadow-xl p-6 w-full max-w-md"
    role="dialog"
    aria-modal="true"
  >
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-xl font-bold text-gray-800">Add Availability</h3>
      <button
        onclick="this.closest('#availability-modal').remove()"
        class="text-gray-500 hover:text-gray-800"
      >
        &times;
      </button>
    </div>

    <form
      hx-post="{% url 'coaching:api_create_availability_from_modal' %}"
      hx-swap="none"
      hx-on::after-request="if(event.detail.successful) { this.closest('#availability-modal').remove(); htmx.trigger('body', 'specific-slot-updated'); } else { alert('Error: ' + event.detail.xhr.responseText); }"
    >
      {% csrf_token %}

      <input type="hidden" name="date" value="{{ date_str }}" />

      <div class="space-y-4">
        <div
          class="p-3 bg-indigo-50 border border-indigo-200 rounded-md text-center">
          <p class="font-semibold text-indigo-800 text-lg">
            {{ selected_date|date:"l, F j, Y" }}
          </p>
        </div>

        <div class="grid grid-cols-2 gap-3">
          <div>
            <label
              for="start_time"
              class="block text-sm font-medium text-gray-700">Start Time</label
            >
            <input
              type="time"
              name="start_time"
              value="09:00"
              required
              class="mt-1 p-2 border rounded-md w-full"
            />
          </div>
          <div>
            <label
              for="end_time"
              class="block text-sm font-medium text-gray-700">End Time</label
            >
            <input
              type="time"
              name="end_time"
              value="17:00"
              required
              class="mt-1 p-2 border rounded-md w-full"
            />
          </div>
        </div>

        <div class="border-t pt-4 space-y-3">
          <p class="text-sm font-medium text-gray-700">
            How should this be applied?
          </p>
          <label
            class="flex items-center p-3 border rounded-md hover:bg-gray-50 cursor-pointer">
            <input
              type="radio"
              name="availability_type"
              value="specific"
              checked
              class="h-4 w-4 text-indigo-600"
            />
            <span class="ml-3 text-sm text-gray-800">Apply to <strong>this date only</strong>.</span>
          </label>
          <label
            class="flex items-center p-3 border rounded-md hover:bg-gray-50 cursor-pointer">
            <input
              type="radio"
              name="availability_type"
              value="recurring"
              class="h-4 w-4 text-indigo-600"
            />
            <span class="ml-3 text-sm text-gray-800"
              >Apply to all future <strong>{{ day_name }}s</strong> (updates weekly schedule).</span>
          </label>
        </div>

        <button
          type="submit"
          class="w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 font-semibold transition"
        >
          Save Availability
        </button>
      </div>
    </form>
  </div>
</div>
