{% extends 'base.html' %}

{% block title %}My Account{% endblock %}

{% block content %}
<div class="prose max-w-none">
    <h1>My Account</h1>
    <p>Welcome back, {{ user.username }}!</p>
    <p>This is your account dashboard. More features will be added here soon.</p>

    <hr class="my-6">

    <h3>Marketing Preferences</h3>
    {% with marketing_preference=user.marketing_preference %}
      <form hx-post="{% url 'update_marketing_preference' %}" hx-target="#marketing-preference-status-wrapper" hx-swap="innerHTML">
        {% csrf_token %}
        <div class="form-check">
          <input class="form-check-input" type="checkbox" name="is_subscribed" id="marketing_opt_in"
                 {% if marketing_preference.is_subscribed %}checked{% endif %}
                 hx-post="{% url 'update_marketing_preference' %}"
                 hx-trigger="change"
                 hx-target="#marketing-preference-status-wrapper"
                 hx-swap="innerHTML">
          <label class="form-check-label" for="marketing_opt_in">
            Receive marketing emails
          </label>
        </div>
      </form>
      <div id="marketing-preference-status-wrapper">
          <p id="marketing-preference-status">
            Current status: <strong>{% if marketing_preference.is_subscribed %}Subscribed{% else %}Unsubscribed{% endif %}</strong>
          </p>
      </div>
    {% endwith %}
</div>
{% endblock %}
