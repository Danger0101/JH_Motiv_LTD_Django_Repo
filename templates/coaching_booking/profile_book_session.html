{% load static %}

<link rel="stylesheet" href="{% static 'css/booking.css' %}">

<div id="booking-wizard-container" class="booking-wizard">
    <div class="wizard-header">
        <h2 class="wizard-title">Book Your Session</h2>
        <p class="wizard-step-indicator">Select a date and time that works for you.</p>
    </div>

    {% if not selected_enrollment %}
    <div class="form-group">
        <label class="form-label">Select Plan:</label>
        <select 
            class="form-select" 
            hx-get="{% url 'coaching_booking:profile_book_session' %}" 
            hx-target="#booking-wizard-container" 
            name="enrollment_id"
            hx-trigger="change"
        >
            <option value="">-- Choose a Plan --</option>
            {% for enrollment in enrollments %}
                <option value="{{ enrollment.id }}">{{ enrollment.offering.name }} ({{ enrollment.remaining_sessions }} left)</option>
            {% endfor %}
        </select>
    </div>
    {% else %}
        
        <div class="calendar-layout">
            <div 
                id="calendar-widget"
                hx-get="{% url 'coaching_booking:calendar_widget' %}?enrollment_id={{ selected_enrollment.id }}&month={{ current_month }}&year={{ current_year }}"
                hx-trigger="load"
            >
                <div style="text-align: center; padding: 2rem;">Loading Calendar...</div>
            </div>

            <div id="time-slots-container">
            </div>
        </div>

        <div style="margin-top: 2rem; display: flex; justify-content: space-between; border-top: 1px solid var(--gray-200); padding-top: 1rem;">
             <button 
                class="btn-secondary" 
                hx-get="{% url 'coaching_booking:profile_book_session' %}" 
                hx-target="#booking-wizard-container"
             >
                &larr; Back to Plans
             </button>
        </div>

    {% endif %}
</div>