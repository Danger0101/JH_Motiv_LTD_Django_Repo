{% extends 'base.html' %}
{% load static %}

{% block title %}About JH Motiv LTD{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-10">
        <h1 class="text-4xl font-extrabold text-gray-900 sm:text-5xl">
            The JH Motiv Movement
        </h1>
    </div>

    <div x-data="{ activeTab: 'about_us' }" class="mt-12">
        <div class="flex flex-wrap justify-center border-b border-gray-200" role="tablist" aria-label="About Sections">
            
            {# 1. STATIC TABS (Our Story, Mission, How We Do It) #}
            {% for key, tab in about_data.tabs.items %}
            <button 
                @click="activeTab = '{{ key }}'"
                :class="{ 'border-blue-500 text-blue-600': activeTab === '{{ key }}', 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300': activeTab !== '{{ key }}' }"
                class="py-3 px-4 text-center border-b-2 font-medium text-base focus:outline-none transition duration-150 ease-in-out"
                role="tab"
                aria-controls="{{ key }}-panel"
                :aria-selected="activeTab === '{{ key }}'"
            >
                {{ tab.title }}
            </button>
            {% endfor %}

            {# 2. DYNAMIC WALL OF DREAMERS TAB BUTTON #}
            <button 
                @click="activeTab = 'dreamers'"
                :class="{ 'border-blue-500 text-blue-600': activeTab === 'dreamers', 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300': activeTab !== 'dreamers' }"
                class="py-3 px-4 text-center border-b-2 font-medium text-base focus:outline-none transition duration-150 ease-in-out"
                role="tab"
                aria-controls="dreamers-panel"
                :aria-selected="activeTab === 'dreamers'"
            >
                Wall of Dreamers ðŸ’«
            </button>
        </div>

        <div class="mt-8">

            {# 1. STATIC CONTENT PANELS (Our Story, Mission, How We Do It, Meet the Team Placeholder) #}
            {% for key, tab in about_data.tabs.items %}
            <div x-show="activeTab === '{{ key }}'" role="tabpanel" id="{{ key }}-panel" aria-labelledby="{{ key }}-tab" class="prose max-w-none lg:prose-lg mx-auto">
                <h2 class="text-3xl font-bold mb-6">{{ tab.heading }}</h2>
                
                {# Check if this is the dynamic Meet the Team panel #}
                {% if key == 'meet_the_team' %}
                    
                    {# --- DYNAMIC MEET THE TEAM GRID CONTENT --- #}
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        {% for member in team_members %}
                        <div class="text-center p-6 border rounded-lg shadow-sm">
                            <img 
                                src="{{ member.profile_image.url }}" 
                                alt="Profile photo of {{ member.name }}"
                                class="w-32 h-32 object-cover rounded-full mx-auto mb-4 border-4 border-blue-500"
                            >
                            <h3 class="text-xl font-bold text-gray-900">{{ member.name }}</h3>
                            <p class="text-blue-600 font-medium mb-3">{{ member.role }}</p>
                            <p class="text-gray-700 text-sm leading-relaxed">{{ member.bio }}</p>
                        </div>
                        {% empty %}
                        <p class="col-span-full text-center text-gray-500">The team is expanding! Check back soon to meet everyone.</p>
                        {% endfor %}
                    </div>
                
                {% else %}
                    {# --- STANDARD STATIC CONTENT LOOP --- #}
                    {% for item in tab.content %}
                        {% if item.type == 'p' %}
                            <p class="text-lg leading-relaxed">{{ item.body|safe }}</p>
                        {% elif item.type == 'list' %}
                            <ul class="list-disc list-inside space-y-2">
                                {% for li in item.items %}
                                    <li>{{ li|safe }}</li>
                                {% endfor %}
                            </ul>
                        {% elif item.type == 'tag' %}
                            <p class="text-xl font-semibold mt-8">{{ item.body|safe }}</p>
                        {% endif %}
                    {% endfor %}
                {% endif %}
            </div>
            {% endfor %}

            {# 2. WALL OF DREAMERS DYNAMIC PANEL #}
            <div x-show="activeTab === 'dreamers'" role="tabpanel" id="dreamers-panel" aria-labelledby="dreamers-tab" x-cloak>
                <div class="prose max-w-none lg:prose-lg mx-auto">
                    <h2 class="text-3xl font-bold mb-6">{{ about_data.dreamers.title }}</h2>
                    <p class="text-lg leading-relaxed mb-8">{{ about_data.dreamers.intro }}</p>

                    <ul role="list" class="space-y-6">
                        {% for dreamer in dreamer_profiles %}
                        <li class="p-4 border rounded-lg flex items-center justify-between">
                            <div>
                                <span class="text-xl font-medium text-gray-900">{{ dreamer.name }}</span>
                                {% if dreamer.story_excerpt %}
                                    <p class="text-sm text-gray-600 mt-1">{{ dreamer.story_excerpt }}</p>
                                {% endif %}
                            </div>
                            <div class="flex space-x-3 ml-4 flex-shrink-0">
                                {% for channel in dreamer.channels.all %}
                                    {# Full SVG logic should be in place here #}
                                    <a href="{{ channel.url }}" target="_blank" aria-label="{{ channel.get_channel_type_display }} for {{ dreamer.name }}" class="text-gray-500 hover:text-blue-600 transition duration-150">
                                        {% with type=channel.channel_type %}
                                        <svg class="h-6 w-6" viewBox="0 0 24 24" fill="currentColor">
                                            {# SVG Path Logic here (omitted for brevity) #}
                                            <title>{{ type|capfirst }}</title>
                                            <path d="M12 0c6.627 0 12 5.373 12 12s-5.373 12-12 12S0 18.627 0 12 5.373 0 12 0zm5.176 8.008a3.176 3.176 0 0 1-5.12 3.864v.016a5.056 5.056 0 0 0 3.056 4.752c-.672.064-1.376.112-2.096.112-2.736 0-5.184-1.28-6.496-3.232a8.624 8.624 0 0 0 .176 6.336c1.136 1.488 2.896 2.592 4.96 3.04V15.04a2.96 2.96 0 0 1-2.944-2.96c0-.016.016-.032.016-.048a1.008 1.008 0 0 0-1.008-.96 1.008 1.008 0 0 0-1.008.96c0 .016.016.032.016.048a4.96 4.96 0 0 0 4.928 4.96c.016 0 .032 0 .048 0a5.056 5.056 0 0 0 5.056-5.056V8.008z"/>
                                        </svg>
                                        {% endwith %}
                                    </a>
                                {% endfor %}
                            </div>
                        </li>
                        {% empty %}
                        <p class="text-center text-gray-500">The Wall of Dreamers is currently being updated! Check back soon to see who we're supporting.</p>
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}