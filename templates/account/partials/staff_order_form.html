<tr id="order-row-{{ order.id }}" class="bg-gray-50">
    <td colspan="4" class="p-4">
        <form hx-post="{% url 'accounts:staff_update_order' order.id %}" hx-target="#order-row-{{ order.id }}" hx-swap="outerHTML">
            {% csrf_token %}
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                
                <div>
                    <label for="status-{{ order.id }}" class="block text-xs font-medium text-gray-700">Status</label>
                    <select id="status-{{ order.id }}" name="status" class="mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md">
                        {% with current_status=order.status|default:"processing" %}
                            <option value="processing" {% if current_status == 'processing' %}selected{% endif %}>Processing</option>
                            <option value="paid" {% if current_status == 'paid' %}selected{% endif %}>Paid</option>
                            <option value="shipped" {% if current_status == 'shipped' %}selected{% endif %}>Shipped</option>
                            <option value="delivered" {% if current_status == 'delivered' %}selected{% endif %}>Delivered</option>
                            <option value="canceled" {% if current_status == 'canceled' %}selected{% endif %}>Canceled</option>
                            <option value="refunded" {% if current_status == 'refunded' %}selected{% endif %}>Refunded</option>
                        {% endwith %}
                    </select>
                </div>

                <div>
                    <label for="carrier-{{ order.id }}" class="block text-xs font-medium text-gray-700">Carrier</label>
                    <input type="text" name="carrier" id="carrier-{{ order.id }}" value="{{ order.carrier|default:'' }}" class="mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                </div>

                <div class="md:col-span-2">
                    <label for="tracking_number-{{ order.id }}" class="block text-xs font-medium text-gray-700">Tracking Number</label>
                    <input type="text" name="tracking_number" id="tracking_number-{{ order.id }}" value="{{ order.tracking_number|default:'' }}" class="mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                </div>

                <div class="md:col-span-2">
                    <label for="tracking_url-{{ order.id }}" class="block text-xs font-medium text-gray-700">Tracking URL</label>
                    <input type="url" name="tracking_url" id="tracking_url-{{ order.id }}" value="{{ order.tracking_url|default:'' }}" class="mt-1 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md">
                </div>

            </div>

            <div class="flex justify-end items-center mt-4 space-x-3">
                <button type="button" 
                        hx-get="{% url 'accounts:staff_get_order_row' order.id %}"
                        hx-target="#order-row-{{ order.id }}"
                        hx-swap="outerHTML"
                        class="px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50">
                    Cancel
                </button>
                <button type="submit" class="px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700">
                    Save Changes
                </button>
            </div>
        </form>
    </td>
</tr>