<div class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50" 
     style="position: fixed; inset: 0; z-index: 50; display: flex; align-items: center; justify-content: center; background-color: rgba(0,0,0,0.5);">
    
    <div class="bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-screen overflow-y-auto p-6" 
         style="background-color: white; border-radius: 0.5rem; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); width: 100%; max-width: 56rem; max-height: 100vh; overflow-y: auto; padding: 1.5rem;"
         @click.away="open = false">
        
        <div class="flex justify-between items-center mb-6" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
            <h2 class="text-2xl font-bold text-gray-800" style="font-size: 1.5rem; font-weight: 700; color: var(--gray-800);">Set Recurring Schedule</h2>
            <button onclick="document.getElementById('dialog-container').innerHTML = ''" style="color: var(--gray-500); font-size: 1.5rem; border: none; background: none; cursor: pointer;">&times;</button>
        </div>

        <div x-data="scheduleEditor('{{ schedule_json|escapejs }}')">
            
            <div class="schedule-grid">
                <template x-for="(day, dayIndex) in schedule" :key="dayIndex">
                    <div class="day-card">
                        <div class="day-title">
                            <span x-text="day.name"></span>
                            <button @click="addSlot(dayIndex)" class="text-blue-600 hover:text-blue-800 text-sm font-bold" style="color: #2563eb; font-size: 0.875rem; border: none; background: none; cursor: pointer;">+ Add</button>
                        </div>

                        <div class="slot-list">
                            <template x-for="(slot, slotIndex) in day.slots" :key="slotIndex">
                                <div class="slot-item">
                                    <div style="display: flex; gap: 0.5rem; align-items: center;">
                                        <input type="time" x-model="slot.start" class="border rounded px-2 py-1 text-sm" style="border: 1px solid #d1d5db; border-radius: 0.25rem; padding: 0.25rem 0.5rem;">
                                        <span>-</span>
                                        <input type="time" x-model="slot.end" class="border rounded px-2 py-1 text-sm" style="border: 1px solid #d1d5db; border-radius: 0.25rem; padding: 0.25rem 0.5rem;">
                                    </div>
                                    <button @click="removeSlot(dayIndex, slotIndex)" class="btn-remove-slot">&times;</button>
                                </div>
                            </template>
                            <div x-show="day.slots.length === 0" style="color: var(--gray-400); font-style: italic; font-size: 0.875rem;">Unavailable</div>
                        </div>
                    </div>
                </template>
            </div>

            <div x-show="isError" style="margin-top: 1.5rem; padding: 1rem; background-color: #fee2e2; color: #b91c1c; border-radius: 0.5rem;" x-text="message" x-cloak></div>
            
            <div x-show="!isError && message" style="margin-top: 1.5rem; padding: 1rem; background-color: #d1fae5; color: #065f46; border-radius: 0.5rem;" x-text="message" x-cloak></div>

            <div class="mt-8 flex justify-end gap-4" style="margin-top: 2rem; display: flex; justify-content: flex-end; gap: 1rem;">
                <button onclick="document.getElementById('dialog-container').innerHTML = ''" class="btn-action btn-secondary-action">Cancel</button>
                <button @click="saveSchedule" class="btn-action btn-primary-action" :disabled="isSaving">
                    <span x-show="!isSaving">Save Changes</span>
                    <span x-show="isSaving">Saving...</span>
                </button>
            </div>
        </div>
    </div>
</div>
