<div class="bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden mb-8">
    <div class="p-5 border-b border-gray-100 flex justify-between items-center bg-gray-50">
        <h3 class="font-bold text-gray-800">Upcoming Sessions</h3>
        <a href="{% url 'coaching_booking:coach_landing' %}" class="text-xs font-semibold text-blue-600 hover:underline">View Public Profile</a>
    </div>
    
    {% if upcoming_sessions %}
    <div class="divide-y divide-gray-100">
        {% for booking in upcoming_sessions %}
        <div class="p-5 hover:bg-gray-50 transition-colors flex flex-col md:flex-row md:items-center justify-between gap-4">
            
            {# Date and Time #}
            <div class="flex items-start gap-4">
                <div class="flex-shrink-0 text-center bg-blue-50 text-blue-700 rounded-lg p-2 min-w-[60px]">
                    <span class="block text-xs font-bold uppercase tracking-wider">{{ booking.start_datetime|date:"M" }}</span>
                    <span class="block text-xl font-extrabold">{{ booking.start_datetime|date:"d" }}</span>
                </div>
                <div>
                    <h4 class="font-bold text-gray-900">{{ booking.workshop.name|default:booking.enrollment.offering.name|default:"1-on-1 Session" }}</h4>
                    <div class="flex items-center text-sm text-gray-600 mt-1">
                        <svg class="w-4 h-4 mr-1 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        {{ booking.start_datetime|date:"g:i A" }} - {{ booking.end_datetime|date:"g:i A" }}
                    </div>
                    <div class="flex items-center text-sm text-gray-500 mt-1">
                        <svg class="w-4 h-4 mr-1 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                        With: <span class="font-medium text-gray-800 ml-1">{{ booking.client.get_full_name }}</span>
                    </div>
                </div>
            </div>

            {# Actions #}
            <div class="flex items-center gap-2 self-start md:self-center">
                {# Reschedule Button #}
                <button hx-get="{% url 'coaching_booking:reschedule_session_form' booking.id %}"
                        hx-target="#reschedule-modal-content"
                        @click="openReschedule = true"
                        class="px-3 py-1.5 text-xs font-bold text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50 transition">
                    Reschedule
                </button>

                {# Cancel Button #}
                <div x-data="{ confirm: false }">
                    <button x-show="!confirm" @click="confirm = true" 
                            class="px-3 py-1.5 text-xs font-bold text-red-600 bg-white border border-red-200 rounded hover:bg-red-50 transition">
                        Cancel
                    </button>
                    <div x-show="confirm" class="flex items-center gap-2" x-cloak>
                        <span class="text-xs text-red-600 font-medium">Sure?</span>
                        <button hx-post="{% url 'coaching_booking:cancel_session' booking.id %}"
                                hx-confirm="Are you sure you want to cancel this session? An email will be sent to the client."
                                class="px-2 py-1 text-xs bg-red-600 text-white rounded font-bold hover:bg-red-700">
                            Yes
                        </button>
                        <button @click="confirm = false" class="text-xs text-gray-500 hover:text-gray-700">âœ•</button>
                    </div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="p-8 text-center text-gray-500 italic">
        No upcoming sessions scheduled.
    </div>
    {% endif %}
</div>

{# Placeholder for Reschedule Modal (Matches the Client one) #}
<div x-data="{ openReschedule: false }" x-show="openReschedule" class="fixed inset-0 z-50 flex items-center justify-center px-4" style="display: none;" x-cloak>
    <div class="fixed inset-0 bg-gray-900 opacity-60" @click="openReschedule = false"></div>
    <div id="reschedule-modal-content" class="bg-white rounded-xl shadow-2xl w-full max-w-lg z-10 relative overflow-hidden min-h-[400px]">
        <div class="flex justify-center items-center h-full p-10"><div class="animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"></div></div>
    </div>
</div>