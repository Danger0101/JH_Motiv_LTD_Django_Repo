{% load static %}

<div id="hook-scene" class="w-full flex flex-col items-center justify-center min-h-[500px] fade-in relative">
    
    <div class="chain-wrapper mb-8 scale-75 md:scale-100">
        <div class="chain-link"></div>
        <div class="chain-link"></div>
        <div class="chain-link weak-link"></div> <div class="chain-link falling"></div>
    </div>

    <div class="text-center z-10 max-w-4xl">
        <h1 class="text-5xl md:text-7xl font-bold mb-2 glitch-text text-white" data-text="STOP BEING AN NPC">
            STOP BEING AN NPC
        </h1>
        
        <p class="text-lg md:text-xl text-green-500 font-mono mb-8 opacity-90">
            <span class="text-white">> PROTOCOL:</span> Don't just take the Red Pill. 
            <span class="text-purple-400 font-bold animate-pulse">Take Both.</span> 
            <br class="hidden md:block">Hack the simulation from the inside.
        </p>

        <div class="flex flex-col md:flex-row gap-6 justify-center items-center mt-8">
            <button onclick="toggleBook(true)" 
                    class="group relative px-8 py-3 bg-green-900/20 border border-green-500 text-green-400 font-mono uppercase tracking-widest hover:bg-green-500 hover:text-black transition-all">
                <span class="absolute inset-0 w-full h-full bg-green-500/10 blur opacity-0 group-hover:opacity-100 transition-opacity"></span>
                [ INITIALIZE_SOURCE_CODE ]
            </button>

            <button hx-get="{% url 'awakening:step_2_offers' %}" 
                    hx-target="#terminal-stage"
                    hx-swap="innerHTML transition:true"
                    class="text-xs text-gray-500 hover:text-white underline underline-offset-4">
                >> SKIP_TUTORIAL (GO TO SELECTION)
            </button>
        </div>
    </div>

</div>

<div id="book-modal" class="hidden fixed inset-0 z-[100] bg-black/95 flex flex-col items-center justify-center p-4">
    
    <div class="absolute top-4 right-4 z-50">
        <button onclick="toggleBook(false)" class="border border-red-500 text-red-500 px-4 py-2 hover:bg-red-900/50">
            [X] CLOSE_VIEWER
        </button>
    </div>

    <div id="book" class="shadow-[0_0_50px_rgba(0,255,65,0.2)]">
        <div class="my-page bg-[#1a1a1a] border-r border-gray-800 p-8 flex flex-col justify-center items-center text-center">
            <h2 class="text-4xl font-bold text-white mb-4">STOP BEING AN NPC</h2>
            <p class="text-green-500">Vol 1. The Awakening</p>
            <div class="mt-12 text-sm text-gray-500">Swipe or Click to Turn ></div>
        </div>

        <div class="my-page bg-[#0f0f0f] text-gray-300 p-8 text-sm md:text-base leading-relaxed border-l border-gray-800 font-serif">
            <h3 class="text-xl text-green-400 mb-4 font-mono">Chapter 1: The Script</h3>
            <p class="mb-4">Wake up. Put clothes on. Grab a snack. Commute.</p>
            <p class="mb-4">This is the ritual. A Pavlovian response to the digital alarm clock that governs 99% of the population.</p>
            <p>You feel it, don't you? The glitch. The feeling that you are a background character in someone else's movie.</p>
        </div>

        <div class="my-page p-8 bg-[#1a1a1a] border-l-2 border-gray-800 flex flex-col items-center justify-center text-center relative">
    
    <h3 class="text-xl text-white mb-2 font-bold uppercase tracking-widest">Mission Data</h3>
    <div class="w-16 h-1 bg-green-500 mb-6"></div>

    <p class="text-gray-400 text-xs mb-8 leading-relaxed font-mono">
        // PROTOCOL: READ_ONLY<br>
        The manual will open in a secure channel (New Tab).<br>
        Do not close this terminal.
    </p>

    <a href="{% static 'awakening/downloads/Book_Stop_Being_an_NPC_Chapter_1.pdf' %}" 
       target="_blank"
       rel="noopener noreferrer"
       class="group relative w-full mb-6 text-decoration-none">
       
        <div class="absolute inset-0 bg-green-500 blur opacity-20 group-hover:opacity-40 transition-opacity"></div>
        <div class="relative border border-green-500 bg-black p-4 flex items-center justify-center gap-3 hover:bg-green-900/20 transition-colors cursor-pointer">
            
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
            </svg>
            
            <div class="text-left">
                <span class="block text-white font-bold text-sm tracking-wider">OPEN MISSION BRIEF</span>
                <span class="block text-[10px] text-green-500 font-mono">View in New Tab >></span>
            </div>
        </div>
    </a>

    <button hx-get="{% url 'awakening:step_2_offers' %}" 
            hx-target="#terminal-stage"
            hx-swap="innerHTML transition:true"
            onclick="toggleBook(false)"
            class="text-gray-500 hover:text-white text-xs underline underline-offset-4 uppercase tracking-widest mt-2">
        I HAVE READ THE DATA. PROCEED >
    </button>

</div>
    </div>

</div>

<script>
    // Initialize Book Logic
    function toggleBook(show) {
        const modal = document.getElementById('book-modal');
        const stage = document.getElementById('hook-scene');
        
        if(show) {
            modal.classList.remove('hidden');
            // Init PageFlip only when shown to save resources
            if(!window.bookInitialized) {
                const pageFlip = new StPageFlip.PageFlip(document.getElementById('book'), {
                    width: 400, height: 600, showCover: true
                });
                pageFlip.loadFromHTML(document.querySelectorAll('.my-page'));
                window.bookInitialized = true;
            }
        } else {
            modal.classList.add('hidden');
        }
    }
</script>